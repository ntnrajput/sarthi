<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SARTHI - Railway Inspection Dashboard</title>

  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- AOS -->
  <link href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css" rel="stylesheet">
  <!-- Custom CSS -->
  <link href="assets/css/styles.css" rel="stylesheet">
</head>
<body>


  <!-- ‚úÖ Navbar Component -->
  <div id="navbar-container"></div>

  <!-- Main Container -->
  <div class="container-fluid py-4">
    <div class="row">
      <!-- Main Content -->
      <main id="content" class="col-12">
        <h1 class="h3 mb-4" data-aos="fade-up">Dashboard</h1>

        <div class="mb-4" data-aos="fade-up" data-aos-delay="100">
          <div class="btn-group flex-wrap" role="group" aria-label="Product Toggle Buttons">
            <input type="radio" class="btn-check" name="productToggle" id="btnERC" autocomplete="off" checked>
            <label class="btn btn-outline-primary" for="btnERC">ERC</label>

            <input type="radio" class="btn-check" name="productToggle" id="btnSleeper" autocomplete="off">
            <label class="btn btn-outline-primary" for="btnSleeper">Sleeper</label>

            <input type="radio" class="btn-check" name="productToggle" id="btnRubberPad" autocomplete="off">
            <label class="btn btn-outline-primary" for="btnRubberPad">GRSP</label>

            <input type="radio" class="btn-check" name="productToggle" id="btnElastomeric" autocomplete="off">
            <label class="btn btn-outline-primary" for="btnElastomeric">Elastomeric Pad</label>

            <input type="radio" class="btn-check" name="productToggle" id="btnRail" autocomplete="off">
            <label class="btn btn-outline-primary" for="btnRail">Rail</label>
          </div>
        </div>

        <!-- KPI Cards -->
        <div class="row g-4 mb-4">
          <div class="col-12 col-sm-6 col-lg-3">
            <div class="card hover-lift">
              <div class="card-body d-flex justify-content-between align-items-center">
                <div>
                  <p class="text-muted mb-1 small">Total Inspected Quantity</p>
                  <h3 class="mb-0" id="totalInspected">3444</h3> <!-- ‚úÖ ID added -->
                </div>
                <div class="fs-1">üìã</div>
              </div>
            </div>
          </div>

          <div class="col-12 col-sm-6 col-lg-3">
            <div class="card hover-lift">
              <div class="card-body d-flex justify-content-between align-items-center">
                <div>
                  <p class="text-muted mb-1 small">Quantity Pending for Inspection</p>
                  <h3 class="mb-0" id="pendingQty">1200</h3> <!-- ‚úÖ ID added -->
                </div>
                <div class="fs-1">‚è≥</div>
              </div>
            </div>
          </div>

          <div class="col-12 col-sm-6 col-lg-3">
            <div class="card hover-lift">
              <div class="card-body d-flex justify-content-between align-items-center">
                <div>
                  <p class="text-muted mb-1 small">Total Accepted Quantity</p>
                  <h3 class="mb-0"><span id="acceptedQty">3000</span></h3> <!-- ‚úÖ ID added -->
                </div>
                <div class="fs-1">‚úÖ</div>
              </div>
            </div>
          </div>

          <div class="col-12 col-sm-6 col-lg-3">
            <div class="card hover-lift">
              <div class="card-body d-flex justify-content-between align-items-center">
                <div>
                  <p class="text-muted mb-1 small">Active Manufacturers</p>
                  <h3 class="mb-0" id="activeMfrs">83</h3> <!-- ‚úÖ ID added -->
                </div>
                <div class="fs-1">üèóÔ∏è</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Charts -->
        <div class="row g-4 mt-2">
          <div class="col-12 col-lg-8" data-aos="fade-up" data-aos-delay="600">
            <div class="card">
              <div class="card-body">
                <h5 class="card-title mb-4">Rejection Trend</h5>
                <canvas id="trendChart" height="80"></canvas>
              </div>
            </div>
          </div>
          <div class="col-12 col-lg-4" data-aos="fade-up" data-aos-delay="700">
            <div class="card">
              <div class="card-body">
                <h5 class="card-title mb-4">Rejection Categorisation</h5>
                <canvas id="statusChart"></canvas>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>
  </div>

  <!-- Footer -->
  <footer class="border-top py-3 mt-4 text-center small text-muted">
    ¬© SARTHI - QIMS ‚Äî v0.1
  </footer>

  <!-- JS Libraries -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.js"></script>
  <!-- App JS -->
  <script src="assets/js/app.js"></script>

  <script>
  // Page Loader
  window.addEventListener('load', () => {
    const loader = document.getElementById('pageLoader');
    setTimeout(() => {
      loader.style.opacity = '0';
      setTimeout(() => loader.style.display = 'none', 500);
    }, 1000);
  });

  // AOS Init
  AOS.init({ duration: 800, once: true });

  // ================================
  // üìä Chart Data for Each Product
  // ================================
  const chartDataSets = {
    ERC: {
      trend: [11.8, 10.7, 6.0, 5.9, 12.1, 12.4],
      status: [3.2, 2.9, 5.2],
      kpi: { total: 3444, pending: 1200, accepted: 3000, manufacturers: 83 }
    },
    Sleeper: {
      trend: [6.9, 11.0, 5.9, 13.6, 11.4, 12.0],
      status: [6.7, 5.9, 4.2],
      kpi: { total: 2800, pending: 950, accepted: 2600, manufacturers: 65 }
    },
    GRSP: {
      trend: [6.6, 7.8, 7.0, 11.9, 8.4, 8.0],
      status: [4.4, 3.0, 5.1],
      kpi: { total: 1900, pending: 500, accepted: 1700, manufacturers: 42 }
    },
    'Elastomeric Pad': {
      trend: [12.4, 14.3, 14.4, 10.6, 12.4, 12.4],
      status: [6.1, 2.5, 4.7],
      kpi: { total: 1500, pending: 400, accepted: 1300, manufacturers: 30 }
    },
    Rail: {
      trend: [7.0, 5.2, 6.3, 9.5, 11.0, 8.8],
      status: [3.5, 3.0, 2.6],
      kpi: { total: 4200, pending: 800, accepted: 4000, manufacturers: 2 }
    }
  };




  // ================================
  // üìà Initialize Charts
  // ================================
  let trendChartInstance = null;
  let statusChartInstance = null;

  function initCharts(product = 'ERC') {
    const trendCtx = document.getElementById('trendChart');
    const statusCtx = document.getElementById('statusChart');
    

    const productData = chartDataSets[product];

    // Trend Chart
    if (trendCtx) {
      if (trendChartInstance) trendChartInstance.destroy();
      trendChartInstance = new Chart(trendCtx, {
        type: 'bar',
        data: {
          labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
          datasets: [{
            label: `${product} Rejection Rate`,
            data: productData.trend,
            borderColor: 'rgb(102, 126, 234)',
            backgroundColor: 'rgba(102, 126, 234, 0.7)',  // ‚úÖ make bars bolder
            borderWidth: 1,
            borderRadius: 6                           // ‚úÖ rounded corners on bars
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: { display: false },
            tooltip: {
              backgroundColor: 'rgba(0,0,0,0.7)',
              titleFont: { weight: 'bold' },
              padding: 10
            }
          },
          scales: {
            x: {
              grid: { display: false },               // ‚úÖ clean x grid
              ticks: { font: { size: 12 } }
            },
            y: {
              beginAtZero: true,
              grid: { color: 'rgba(0,0,0,0.05)' },
              ticks: { stepSize: 20 }
            }
          }
        }
      });
    }


    // Status Chart
    if (statusCtx) {
      if (statusChartInstance) statusChartInstance.destroy();
      statusChartInstance = new Chart(statusCtx, {
        type: 'doughnut',
        data: {
          labels: ['Raw Material', 'Process', 'Final Inspection'],
          datasets: [{
            data: productData.status,
            backgroundColor: [
              'rgba(102, 126, 234, 0.8)',
              'rgba(255, 193, 7, 0.8)',
              'rgba(220, 53, 69, 0.8)'
            ]
          }]
        },
        options: {
          responsive: true,
          plugins: { legend: { position: 'top' ,
            labels:{
              padding: 15,
              boxWidth:20,
              font: {size:14}
            }
          } }
        }
      });
    }
    document.getElementById('totalInspected').textContent = productData.kpi.total;
    document.getElementById('pendingQty').textContent = productData.kpi.pending;
    document.getElementById('acceptedQty').textContent = productData.kpi.accepted;
    document.getElementById('activeMfrs').textContent = productData.kpi.manufacturers;
  }

  // Initialize with ERC as default
  window.addEventListener('load', () => initCharts('ERC'));

  // ================================
  // üñ±Ô∏è Handle Product Toggle Buttons
  // ================================
  document.querySelectorAll('input[name="productToggle"]').forEach(btn => {
    btn.addEventListener('change', (e) => {
      if (e.target.checked) {
        const product = e.target.nextElementSibling.textContent.trim();
        console.log(`‚úÖ Selected Product: ${product}`);
        initCharts(product);
      }
    });
  });
</script>

</body>
</html>
